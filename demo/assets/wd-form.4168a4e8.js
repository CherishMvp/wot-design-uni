import{d as s,U as e,p as a,o,c as r,w as t,y as p,n as l,u as n,i as u}from"./index-5dc556e1.js";import{I as m,h as c,J as i,z as d,F as f,a as h}from"./page-wraper.eeca02a0.js";import{u as g}from"./useChildren.f9480853.js";const y=h(s({name:"wd-form",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{model:null,rules:{default:()=>({})},customClass:{default:""},customStyle:{default:""}},setup(s,{expose:h}){const y=s,{children:v,linkChildren:b}=g(f);let w=e({});function C(){Object.keys(w).forEach((s=>{w[s]=""}))}return b({props:y,errorMessages:w}),a((()=>y.model),(()=>{C()}),{immediate:!0,deep:!0}),h({validate:async function(s){const e=[];let a=!0;const o=[],r=function(){const s=d(y.rules);return v.forEach((e=>{c(e.prop)&&c(e.rules)&&e.rules.length&&(s[e.prop]?s[e.prop]=[...s[e.prop],...e.rules]:s[e.prop]=e.rules)})),s}(),t=s?{[s]:r[s]}:r;for(const p in t){const s=t[p],r=m(y.model,p);if(s&&s.length>0)for(const t of s){if(t.required&&(!c(r)||""===r)){e.push({prop:p,message:t.message}),a=!1;break}if(t.pattern&&!t.pattern.test(y.model[p])){e.push({prop:p,message:t.message}),a=!1;break}const{validator:s,...l}=t;if(s){const r=s(y.model[p],l);i(r)?o.push(r.then((s=>{"string"==typeof s?(e.push({prop:p,message:s}),a=!1):"boolean"!=typeof s||s||(e.push({prop:p,message:t.message}),a=!1)})).catch((s=>{e.push({prop:p,message:s||t.message}),a=!1}))):r||(e.push({prop:p,message:t.message}),a=!1)}}}return await Promise.all(o),e.forEach((s=>{var e;(e=s).message&&(w[e.prop]=e.message)})),{valid:a,errors:e}},reset:function(){C()}}),(e,a)=>{const m=u;return o(),r(m,{class:l(`wd-form ${s.customClass}`),style:n(s.customStyle)},{default:t((()=>[p(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-0c1de4f1"]]);export{y as _};
