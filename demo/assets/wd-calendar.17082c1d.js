var e=Object.defineProperty,a=(a,t,l)=>(((a,t,l)=>{t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l})(a,"symbol"!=typeof t?t+"":t,l),l);import{d as t,r as l,p as s,q as r,o as n,c as i,w as o,n as u,v as d,i as c,a as m,y as f,u as h,e as p,b as g,t as w,F as y,m as v,f as _,g as Y,h as b}from"./index-5dc556e1.js";import{v as D,j as M,y as k,z as S,i as $,b as C,H as x,F as H,a as T}from"./page-wraper.eeca02a0.js";import{_ as O,a as V}from"./wd-tabs.db40d386.js";import{_ as B}from"./wd-tag.0aa34640.js";import{i as F,_ as Z,g as j}from"./wd-calendar-view.fabdfb8e.js";import{_ as W}from"./wd-button.4cb1c8d4.js";import{_ as z}from"./wd-action-sheet.2da7caf6.js";class I{constructor(e){a(this,"utc"),a(this,"date"),a(this,"timeZone"),a(this,"timeZoneString"),a(this,"mYear"),a(this,"mMonth"),a(this,"mDay"),a(this,"mWeek"),a(this,"mHour"),a(this,"mMinute"),a(this,"mSecond"),this.utc=!1;const t=this.parseConfig(e);this.date=new Date(t),this.timeZone=this.date.getTimezoneOffset()/60,this.timeZoneString=this.padNumber(String(-1*this.timeZone).replace(/^(.)?(\d)/,"$10$200"),5,"+"),this.mYear=this.date.getFullYear(),this.mMonth=this.date.getMonth(),this.mDay=this.date.getDate(),this.mWeek=this.date.getDay(),this.mHour=this.date.getHours(),this.mMinute=this.date.getMinutes(),this.mSecond=this.date.getSeconds()}parseConfig(e){return e?e instanceof Date?e:/^(\d){8}$/.test(e)?(this.utc=!0,`${e.substr(0,4)}-${e.substr(4,2)}-${e.substr(6,2)}`):e:new Date}padNumber(e,a,t){return!e||e.length>=a?e:`${Array(a+1-e.length).join(t)}${e}`}year(){return this.mYear}month(){return this.mMonth}unix(){const e=this.utc?60*this.timeZone*60*1e3:0;return Math.floor((this.date.getTime()+e)/1e3)}toString(){return this.date.toUTCString()}startOf(e){switch(e){case"year":return new I(new Date(this.year(),0,1));case"month":return new I(new Date(this.year(),this.month(),1));default:return this}}add(e,a){let t;switch(a){case"m":case"minutes":t=60;break;case"h":case"hours":t=3600;break;case"d":case"days":t=86400;break;case"w":case"weeks":t=604800;break;default:t=1}const l=this.unix()+e*t;return new I(1e3*l)}subtract(e,a){return this.add(-1*e,a)}format(e="YYYY-MM-DDTHH:mm:ssZ"){const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e.replace(/Y{2,4}|M{1,2}|D{1,2}|d{1,4}|H{1,2}|m{1,2}|s{1,2}|Z{1,2}/g,(e=>{switch(e){case"YY":return String(this.mYear).slice(-2);case"YYYY":return String(this.mYear);case"M":return String(this.mMonth+1);case"MM":return this.padNumber(String(this.mMonth+1),2,"0");case"D":return String(this.mDay);case"DD":return this.padNumber(String(this.mDay),2,"0");case"d":return String(this.mWeek);case"dddd":return a[this.mWeek];case"H":return String(this.mHour);case"HH":return this.padNumber(String(this.mHour),2,"0");case"m":return String(this.mMinute);case"mm":return this.padNumber(String(this.mMinute),2,"0");case"s":return String(this.mSecond);case"ss":return this.padNumber(String(this.mSecond),2,"0");case"Z":return`${this.timeZoneString.slice(0,-2)}:00`;case"ZZ":return this.timeZoneString;default:return e}}))}}function q(e){return new I(e)}const A=T(t({name:"wd-calendar",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{customClass:{default:""},customViewClass:{default:""},customLabelClass:{default:""},customValueClass:{default:""},modelValue:null,type:{default:"date"},minDate:{default:new Date((new Date).getFullYear(),(new Date).getMonth()-6,(new Date).getDate()).getTime()},maxDate:{default:new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate(),23,59,59).getTime()},firstDayOfWeek:{default:0},formatter:null,maxRange:null,rangePrompt:null,allowSameDay:{type:Boolean,default:!1},defaultTime:null,timeFilter:null,hideSecond:{type:Boolean,default:!1},label:null,labelWidth:null,useLabelSlot:{type:Boolean,default:!1},useDefaultSlot:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:null,title:null,alignRight:{type:Boolean,default:!1},error:{type:Boolean,default:!1},required:{type:Boolean,default:!1},size:null,center:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},zIndex:{default:15},showConfirm:{type:Boolean,default:!0},confirmText:null,displayFormat:null,innerDisplayFormat:null,ellipsis:{type:Boolean,default:!1},showTypeSwitch:{type:Boolean,default:!1},shortcuts:{default:()=>[]},onShortcutsClick:null,safeAreaInsetBottom:{type:Boolean,default:!0},beforeConfirm:null,prop:null,rules:{default:()=>[]}},emits:["cancel","change","update:modelValue","confirm"],setup(e,{emit:a}){const t=e,T=(e,a)=>{switch(a){case"date":return q(e).format("YYYY-MM-DD");case"dates":return e.map((e=>q(e).format("YYYY-MM-DD"))).join(", ");case"daterange":return`${e[0]?q(e[0]).format("YYYY-MM-DD"):"开始时间"} 至 ${e[1]?q(e[1]).format("YYYY-MM-DD"):"结束时间"}`;case"datetime":return q(e).format("YYYY-MM-DD HH:mm:ss");case"datetimerange":return`${e[0]?q(e[0]).format("YY年MM月DD日 HH:mm:ss"):"开始时间"} 至\n${e[1]?q(e[1]).format("YY年MM月DD日 HH:mm:ss"):"结束时间"}`;case"week":{const a=new Date(e).getFullYear(),t=j(e);return`${a} 第 ${x(t)} 周`}case"weekrange":{const a=new Date(e[0]).getFullYear(),t=j(e[0]),l=new Date(e[1]).getFullYear(),s=j(e[1]);return`${e[0]?`${a} 第 ${x(t)} 周`:"开始周"} - ${e[1]?`${l} 第 ${x(s)} 周`:"结束周"}`}case"month":return q(e).format("YYYY / MM");case"monthrange":return`${e[0]?q(e[0]).format("YYYY / MM"):"开始月"} 至 ${e[1]?q(e[1]).format("YYYY / MM"):"结束月"}`}},I=(e,a,t)=>{switch(t){case"daterange":return e?q(e).format("YYYY年MM月DD日"):"end"===a?"结束时间":"开始时间";case"datetimerange":return e?q(e).format("YY年MM月DD日 HH:mm:ss"):"end"===a?"结束时间":"开始时间";case"weekrange":if(!e)return"end"===a?"结束周":"开始周";return new Date(e).getFullYear()+"年第"+j(e)+"周";case"monthrange":return e?q(e).format("YYYY年MM月"):"end"===a?"结束月":"开始月"}},A=l(!1),N=l(null),L=l(null),P=l(338),R=l(!0),U=l(""),G=l(0),J=l(0),Q=l("date"),E=l("date"),K=l(!1),X=l([]),ee=D(),ae=l(),te=l();s((()=>t.modelValue),((e,a)=>{k(e,a)||(N.value=S(e),R.value=ce(e),ge(),t.type.indexOf("range")>-1&&pe())}),{immediate:!0}),s((()=>t.type),((e,a)=>{if(t.showTypeSwitch){const a=["date","week","month"],t=["daterange","weekrange","monthrange"],l=e.indexOf("range")>-1?t.indexOf(e)||0:a.indexOf(e);G.value=l}P.value=t.showConfirm?338:400,Q.value=S(e),ge(),t.type.indexOf("range")>-1&&pe()}),{deep:!0,immediate:!0}),s((()=>t.showConfirm),(e=>{P.value=e?338:400}),{deep:!0,immediate:!0});const{parent:le}=M(H),se=r((()=>le&&t.prop&&le.errorMessages&&le.errorMessages[t.prop]?le.errorMessages[t.prop]:"")),re=r((()=>{let e=!1;if(le&&le.props.rules){const a=le.props.rules;for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&l===t.prop&&Array.isArray(a[l])&&(e=a[l].some((e=>e.required)))}return t.required||t.rules.some((e=>e.required))||e})),ne=r((()=>e=>F(e)));function ie(){ae.value&&ae.value&&ae.value.$.exposed.scrollIntoView()}function oe(){const{disabled:e,readonly:a}=t;e||a||(K.value=!0,A.value=!0,L.value=S(N.value),J.value=G.value,E.value=Q.value,ie(),setTimeout((()=>{t.showTypeSwitch&&(te.value.scrollIntoView(),te.value.updateLineStyle(!1))}),250))}function ue(){A.value=!1,ie(),setTimeout((()=>{N.value=S(L.value),G.value=J.value,Q.value=E.value,R.value=ce(L.value)}),250),a("cancel")}function de({index:e}){const a=t.type.indexOf("range")>-1?["daterange","weekrange","monthrange"][e]:["date","week","month"][e];G.value=e,Q.value=a}function ce(e){let a=!1;return(!(t.type.indexOf("range")>-1)||e[0]&&e[1]&&e)&&("dates"!==t.type||0!==e.length&&e)&&e||(a=!0),a}function me({value:e}){N.value=S(e),R.value=ce(e),a("change",{value:e}),t.type.indexOf("range")>-1&&pe(),t.showConfirm||R.value||fe()}function fe(){t.beforeConfirm?t.beforeConfirm({value:N.value,resolve:e=>{e&&he()}}):he()}function he(){A.value=!1,a("update:modelValue",N.value),a("confirm",{value:N.value}),ge()}function pe(){const[e,a]=S($(N.value)?N.value:[]);X.value=[e,a].map(((e,a)=>(t.innerDisplayFormat||I)(e,0===a?"start":"end",Q.value)))}function ge(){!(N.value instanceof Array)&&N.value||N.value instanceof Array&&N.value.length?U.value=(t.displayFormat||T)(N.value,Q.value):U.value=""}return(a,l)=>{const s=c,r=Y(b("wd-icon"),C),D=Y(b("wd-tab"),O),M=Y(b("wd-tabs"),V),k=Y(b("wd-tag"),B),$=Y(b("wd-calendar-view"),Z),x=Y(b("wd-button"),W),H=Y(b("wd-action-sheet"),z);return n(),i(s,{class:u(`wd-calendar ${d(ee).border.value?"is-border":""} ${e.customClass}`)},{default:o((()=>[m(s,{class:"wd-calendar__field",onClick:oe},{default:o((()=>[e.useDefaultSlot?f(a.$slots,"default",{key:0},void 0,!0):(n(),i(s,{key:1,class:u(`wd-calendar__cell ${e.disabled?"is-disabled":""} ${e.readonly?"is-readonly":""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.size?"is-"+e.size:""} ${e.center?"is-center":""}`)},{default:o((()=>[e.label||e.useLabelSlot?(n(),i(s,{key:0,class:u(`wd-calendar__label ${d(re)?"is-required":""} ${e.customLabelClass}`),style:h(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:o((()=>[e.label?(n(),p(y,{key:0},[g(w(e.label),1)],64)):f(a.$slots,"label",{key:1},void 0,!0)])),_:3},8,["class","style"])):v("v-if",!0),m(s,{class:"wd-calendar__body"},{default:o((()=>[m(s,{class:"wd-calendar__value-wraper"},{default:o((()=>[m(s,{class:u(`wd-calendar__value ${e.ellipsis?"is-ellipsis":""} ${e.customValueClass} ${U.value?"":"wd-calendar__value--placeholder"}`)},{default:o((()=>[g(w(U.value||e.placeholder||"请选择"),1)])),_:1},8,["class"]),e.disabled||e.readonly?v("v-if",!0):(n(),i(r,{key:0,"custom-class":"wd-calendar__arrow",name:"arrow-right"}))])),_:1}),d(se)?(n(),i(s,{key:0,class:"wd-calendar__error-message"},{default:o((()=>[g(w(d(se)),1)])),_:1})):v("v-if",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),m(H,{modelValue:A.value,"onUpdate:modelValue":l[2]||(l[2]=e=>A.value=e),duration:250,"close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"z-index":e.zIndex,onClose:ue},{default:o((()=>[m(s,{class:"wd-calendar__header"},{default:o((()=>[e.showTypeSwitch||0!==e.shortcuts.length?v("v-if",!0):(n(),i(s,{key:0,class:"wd-calendar__title"},{default:o((()=>[g(w(e.title||"选择日期"),1)])),_:1})),e.showTypeSwitch?(n(),i(s,{key:1,class:"wd-calendar__tabs"},{default:o((()=>[m(M,{ref_key:"calendarTabs",ref:te,modelValue:G.value,"onUpdate:modelValue":l[0]||(l[0]=e=>G.value=e),onChange:de},{default:o((()=>[m(D,{title:"日",name:"日"}),m(D,{title:"周",name:"周"}),m(D,{title:"月",name:"月"})])),_:1},8,["modelValue"])])),_:1})):v("v-if",!0),e.shortcuts.length>0?(n(),i(s,{key:2,class:"wd-calendar__shortcuts"},{default:o((()=>[(n(!0),p(y,null,_(e.shortcuts,((e,a)=>(n(),i(k,{key:a,"custom-class":"wd-calendar__tag",type:"primary",plain:"",round:"",onClick:e=>function(e){t.onShortcutsClick&&"function"==typeof t.onShortcutsClick&&(N.value=S(t.onShortcutsClick({item:t.shortcuts[e],index:e})),R.value=ce(N.value),t.type.indexOf("range")>-1&&pe()),t.showConfirm||fe()}(a)},{default:o((()=>[g(w(e.text),1)])),_:2},1032,["onClick"])))),128))])),_:1})):v("v-if",!0),m(r,{"custom-class":"wd-calendar__close",name:"add",onClick:ue})])),_:1}),K.value?(n(),i(s,{key:0,class:u(`wd-calendar__view  ${Q.value.indexOf("range")>-1?"is-range":""} ${e.showConfirm?"is-show-confirm":""}`)},{default:o((()=>[d(ne)(e.type)?(n(),i(s,{key:0,class:u("wd-calendar__range-label "+("monthrange"===e.type?"is-monthrange":""))},{default:o((()=>[m(s,{class:u("wd-calendar__range-label-item "+(N.value&&N.value[0]?"":"is-placeholder")),style:{"text-align":"right"}},{default:o((()=>[g(w(X.value[0]),1)])),_:1},8,["class"]),m(s,{class:"wd-calendar__range-sperator"},{default:o((()=>[g("/")])),_:1}),m(s,{class:u("wd-calendar__range-label-item "+(N.value&&N.value[1]?"":"is-placeholder"))},{default:o((()=>[g(w(X.value[1]),1)])),_:1},8,["class"])])),_:1},8,["class"])):v("v-if",!0),m($,{ref_key:"calendarView",ref:ae,modelValue:N.value,"onUpdate:modelValue":l[1]||(l[1]=e=>N.value=e),type:Q.value,"min-date":e.minDate,"max-date":e.maxDate,"first-day-of-week":e.firstDayOfWeek,formatter:e.formatter,"panel-height":P.value,"max-range":e.maxRange,"range-prompt":e.rangePrompt,"allow-same-day":e.allowSameDay,"default-time":e.defaultTime,"time-filter":e.timeFilter,"hide-second":e.hideSecond,"show-panel-title":!d(ne)(e.type),onChange:me},null,8,["modelValue","type","min-date","max-date","first-day-of-week","formatter","panel-height","max-range","range-prompt","allow-same-day","default-time","time-filter","hide-second","show-panel-title"])])),_:1},8,["class"])):v("v-if",!0),e.showConfirm?(n(),i(s,{key:1,class:"wd-calendar__confirm"},{default:o((()=>[m(x,{block:"",disabled:R.value,onClick:fe},{default:o((()=>[g(w(e.confirmText||"确定"),1)])),_:1},8,["disabled"])])),_:1})):v("v-if",!0)])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])])),_:3},8,["class"])}}}),[["__scopeId","data-v-f31a45fd"]]);export{A as _,q as d};
